name: Build RPM

on:
  workflow_call:
    inputs:
      version:
        required: true
        type: string
      dry_run:
        required: true
        type: boolean
  workflow_dispatch:

jobs:
  build_rpm:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4
        with:
          ref: ${{ inputs.version }}

      # copr webhook trigger
      - name: Trigger Copr Webhook
        run: curl -X POST https://copr.fedorainfracloud.org/webhooks/trigger/12345/abcdef

      # - name: Use pnpm
      #   uses: pnpm/action-setup@v4
      #   with:
      #     version: 9.10.0

      # - name: Setup node
      #   uses: actions/setup-node@v4
      #   with:
      #     node-version: 20.x
      #     registry-url: https://registry.npmjs.org/
      #     cache: "pnpm"

      # - name: Install dependencies
      #   run: pnpm install --frozen-lockfile

      # - name: Build
      #   run: pnpm build

      # - name: Publish
      #   run: pnpm publish -F artalk --no-git-checks ${{ inputs.dry_run && '--dry-run' || '' }}
      #   env:
      #     NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
